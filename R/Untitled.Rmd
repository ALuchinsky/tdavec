---
title: "R Notebook"
output: html_notebook
---

```{r}
install.packages("TDAvec")
```

```{r}
library(TDAvec)
```

```{r}
createEllipse <- function(n=100, a=1, b=1, sd = 0.1) {
  phi <- runif(n, 0, 2*pi)
  r = runif(n, 1-sd, 1+sd)
  x <- a*r*cos(phi)
  y <- b*r*sin(phi)
  cbind(x, y)
}
```

```{r}
library(ggplot2)
library(magrittr)
```

```{r}
install.packages("rlist")
```

```{r}
library(rlist)
```

```{r}
save_figure <- function(name) {
  ggsave(paste0("../paper_v2/figs/",name,".png"))
}
```



```{r}
set.seed(123)
epsList <- round(as.vector(read.csv("./epsList.csv", header = FALSE))[[1]], 3)
clouds <- lapply(epsList, function(e) createEllipse(100, a=1, b=e))
PDs <- list.rbind( lapply(1:4, function(i) 
  data.frame(x = clouds[[i]][,1], y=clouds[[i]][,2], e=epsList[i])))
PDs %>% ggplot(aes(x=x, y=y)) + geom_point() + facet_wrap(~e) + theme(aspect.ratio = 1)
save_figure("Rclouds")
```

