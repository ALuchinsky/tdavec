---
title: "TDAVec/Python"
output: html_document
date: "2025-04-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data for omparing with python

```{r}
library(TDAvec)
library(TDAstats)
library(TDA)
```


```{r}
X  = read.csv("../tdavec/unitCircle.csv")
plot(X[,1], X[,2])
```

```{r}
scaleSeq = seq(0, 2, length.out = 11)
D = ripsDiag(X, 1, 2)$diagram
```



```{r}
PL = computePersistenceLandscape(D, homDim = 0, scaleSeq = scaleSeq)
PL
```

# VPB

```{r}
PD = D
PD[,3] = PD[,3] - PD[,2]
```

```{r}
ySeq0 = quantile(PD[PD[,1]==0,3], seq(0, 1.1, by=0.2))
R = computePersistenceBlock(PD, homDim = 0, xSeq = c(2), ySeq = ySeq0, tau = 0.3)
pyth = c(0.809001048929071, 3.64481540058609, 5.48661206724003, 6.38281631026758, 1.01395250734014)
plot(R, type = "o")
lines(pyth, col = "red")
```

```{r}
xSeq1 = quantile(PD[PD[,1]==1,2], seq(0, 1.1, by=0.2))
ySeq1 = quantile(PD[PD[,1]==1,3], seq(0, 1.1, by=0.2))
R = computePersistenceBlock(PD, homDim = 1, xSeq = xSeq1, ySeq = ySeq1, tau = 0.3)
pyth = c(0, 0.000499559782281428, 0.00903377330326861, 0.0305098817964819, 
             0.00579736873795015, 0.00951944957273334, 0.0261053156675721, 0.0203673036116531, 
             0.00428701302896287, 0.0107446149362357, 0.0425768331028477, 0.105346832126612,
               0.145880724120365, 0, 0, 0.0328035481022359, 0.0276785592055745, 0.108908859370022, 
               0.131882225448411, 0.0168304894683267, 0.293939456124958, 0.316298612637143, 0.334451098933436,
                 0.356748693217673, 0.36362269411629)
plot(R, type = "o")
lines(pyth, col = "red")
```
# PI

```{r}
PD = D
PD[,3] = PD[,3] - PD[,2]
```

```{r}
resB = 5
resP = 5
minPH0 = min(PD[PD[,1]==0,3])
maxPH0 = max(PD[PD[,1]==0,3])
ySeq0 = seq(minPH0, maxPH0, length.out = resP+1)
xSeq0 = rep(0, resP+1)

sigma = 0.5*(maxPH0 - minPH0)/resP
R = computePersistenceImage(PD, homDim = 0, xSeq = c(2), ySeq = ySeq0, sigma = sigma)
pyth = c(4.56670703042467, 0.965627354019496, 0.0113500659339766, 0.0227233996700507, 0.477249868112126)
plot(R, type = "o")
lines(pyth, col = "red")
```

```{r}
resB = 5
resP = 5

minBH1 = min(PD[PD[,1]==1,2])
maxBH1 = max(PD[PD[,1]==1,2])

minPH1 = min(PD[PD[,1]==1,3])
maxPH1 = max(PD[PD[,1]==1,3])

ySeq1 = seq(minPH1, maxPH1, length.out = resP+1)
xSeq1 = seq(minBH1, maxBH1, length.out = resP+1)

sigma = 0.5*(maxPH1 - minPH1)/resP
R = computePersistenceImage(PD, homDim = 1, xSeq = xSeq1, ySeq = ySeq1, sigma = sigma)
pyth = c( 0.0437160130945874, 0.0495556729840402, 0.0451237783565141, 0.0329995660586893, 0.0186444239574634, 
                 0.00752765376757397, 0.00776084705021553, 0.00630598644271661, 0.00425097166237492, 0.00227854726438653, 
                 6.03800613955066e-05, 5.84101446147877e-05, 4.42739912785808e-05, 3.09472597878289e-05, 
                 2.02106358360438e-05, 0.000183467522328633, 0.00089210088336952, 0.00271421546306594, 
                 0.00517182299303047, 0.00617537792830458, 0.00385383980210524, 0.0187402270298275, 0.0570177372523999, 
                 0.108645123651971, 0.12972698923131)
plot(R, type = "o")
lines(pyth, col = "red")
```

# computeAlgebraicFunctions



```{r}
computeAlgebraicFunctions(D, 0)
```

```{r}
computeLimits(list(D), 0)
```

